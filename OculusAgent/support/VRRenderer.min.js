"use strict";THREE.VRRenderer=function(e,t){var n=this;n.initialize=function(){var e=t.getEyeTranslation("left");n.halfIPD=new THREE.Vector3(e.x,e.y,e.z).length(),n.fovLeft=t.getRecommendedEyeFieldOfView("left"),n.fovRight=t.getRecommendedEyeFieldOfView("right")},n.FovToNDCScaleOffset=function(e){var t=2/(e.leftTan+e.rightTan),n=(e.leftTan-e.rightTan)*t*.5,o=2/(e.upTan+e.downTan),a=(e.upTan-e.downTan)*o*.5;return{scale:[t,o],offset:[n,a]}},n.FovPortToProjection=function(e,t,o,a){t=void 0===t?!0:t,o=void 0===o?.01:o,a=void 0===a?1e4:a;var r=t?-1:1,i=new THREE.Matrix4,f=i.elements,l=n.FovToNDCScaleOffset(e);return f[0]=l.scale[0],f[1]=0,f[2]=l.offset[0]*r,f[3]=0,f[4]=0,f[5]=l.scale[1],f[6]=-l.offset[1]*r,f[7]=0,f[8]=0,f[9]=0,f[10]=a/(o-a)*-r,f[11]=a*o/(o-a),f[12]=0,f[13]=0,f[14]=r,f[15]=0,i.transpose(),i},n.FovToProjection=function(e,t,o,a){var r={upTan:Math.tan(e.upDegrees*Math.PI/180),downTan:Math.tan(e.downDegrees*Math.PI/180),leftTan:Math.tan(e.leftDegrees*Math.PI/180),rightTan:Math.tan(e.rightDegrees*Math.PI/180)};return n.FovPortToProjection(r,t,o,a)},n.render=function(t,o){var a=o.clone(),r=o.clone();a.projectionMatrix=n.FovToProjection(n.fovLeft,!0,o.near,o.far),r.projectionMatrix=n.FovToProjection(n.fovRight,!0,o.near,o.far);var i=new THREE.Vector3(1,0,0);i.applyQuaternion(o.quaternion),a.position.sub(i.clone().multiplyScalar(n.halfIPD)),r.position.add(i.clone().multiplyScalar(n.halfIPD)),e.enableScissorTest(!0);var f=e.domElement.width/2,l=e.domElement.height;e.setViewport(0,0,f,l),e.setScissor(0,0,f,l),e.render(t,a),e.setViewport(f,0,f,l),e.setScissor(f,0,f,l),e.render(t,r)},n.initialize()};
